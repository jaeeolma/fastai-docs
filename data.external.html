---

title: External data

keywords: fastai
sidebar: home_sidebar

summary: "Helper functions to download the fastai datasets"
description: "Helper functions to download the fastai datasets"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/04_data.external.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A complete list of datasets that are available by default isnide the library are:</p>
<p><strong>Main datasets</strong>:</p>
<ol>
<li><strong>ADULT_SAMPLE</strong>: A small of the <a href="https://archive.ics.uci.edu/ml/datasets/Adult">adults dataset</a> to  predict whether income exceeds $50K/yr based on census data. </li>
</ol>
<ul>
<li><strong>BIWI_SAMPLE</strong>: A <a href="https://www.kaggle.com/kmader/biwi-kinect-head-pose-database">BIWI kinect headpose database</a>. The dataset contains over 15K images of 20 people (6 females and 14 males - 4 people were recorded twice). For each frame, a depth image, the corresponding rgb image (both 640x480 pixels), and the annotation is provided. The head pose range covers about +-75 degrees yaw and +-60 degrees pitch. </li>
</ul>
<ol>
<li><strong>CIFAR</strong>: The famous <a href="https://www.cs.toronto.edu/~kriz/cifar.html">cifar-10</a> dataset which consists of 60000 32x32 colour images in 10 classes, with 6000 images per class.      </li>
<li><strong>COCO_SAMPLE</strong>: A sample of the <a href="http://cocodataset.org/#home">coco dataset</a> for object detection. </li>
<li><strong>COCO_TINY</strong>: A tiny version of the <a href="http://cocodataset.org/#home">coco dataset</a> for object detection.</li>
</ol>
<ul>
<li><strong>HUMAN_NUMBERS</strong>: A synthetic dataset consisting of human number counts in text such as one, two, three, four.. Useful for experimenting with Language Models.</li>
<li><p><strong>IMDB</strong>: The full <a href="https://ai.stanford.edu/~amaas/data/sentiment/">IMDB sentiment analysis dataset</a>.</p>
</li>
<li><p><strong>IMDB_SAMPLE</strong>: A sample of the full <a href="https://ai.stanford.edu/~amaas/data/sentiment/">IMDB sentiment analysis dataset</a>.</p>
</li>
<li><strong>ML_SAMPLE</strong>: A movielens sample dataset for recommendation engines to recommend movies to users.            </li>
<li><strong>ML_100k</strong>: The movielens 100k dataset for recommendation engines to recommend movies to users.             </li>
<li><strong>MNIST_SAMPLE</strong>: A sample of the famous <a href="http://yann.lecun.com/exdb/mnist/">MNIST dataset</a> consisting of handwritten digits.        </li>
<li><strong>MNIST_TINY</strong>: A tiny version of the famous <a href="http://yann.lecun.com/exdb/mnist/">MNIST dataset</a> consisting of handwritten digits.                   </li>
<li><strong>MNIST_VAR_SIZE_TINY</strong>:  </li>
<li><strong>PLANET_SAMPLE</strong>: A sample of the planets dataset from the Kaggle competition <a href="https://www.kaggle.com/c/planet-understanding-the-amazon-from-space">Planet: Understanding the Amazon from Space</a>.</li>
<li><strong>PLANET_TINY</strong>: A tiny version  of the planets dataset from the Kaggle competition <a href="https://www.kaggle.com/c/planet-understanding-the-amazon-from-space">Planet: Understanding the Amazon from Space</a> for faster experimentation and prototyping.</li>
<li><strong>IMAGENETTE</strong>: A smaller version of the <a href="http://www.image-net.org/">imagenet dataset</a> pronounced just like 'Imagenet', except with a corny inauthentic French accent. </li>
<li><strong>IMAGENETTE_160</strong>: The 160px version of the Imagenette dataset.      </li>
<li><strong>IMAGENETTE_320</strong>: The 320px version of the Imagenette dataset. </li>
<li><strong>IMAGEWOOF</strong>: Imagewoof is a subset of 10 classes from Imagenet that aren't so easy to classify, since they're all dog breeds.</li>
<li><strong>IMAGEWOOF_160</strong>: 160px version of the ImageWoof dataset.        </li>
<li><strong>IMAGEWOOF_320</strong>: 320px version of the ImageWoof dataset.</li>
<li><strong>IMAGEWANG</strong>: Imagewang contains Imagenette and Imagewoof combined, but with some twists that make it into a tricky semi-supervised unbalanced classification problem</li>
<li><strong>IMAGEWANG_160</strong>: 160px version of Imagewang.        </li>
<li><strong>IMAGEWANG_320</strong>: 320px version of Imagewang. </li>
</ul>
<p><strong>Kaggle competition datasets</strong>:</p>
<ol>
<li><strong>DOGS</strong>: Image dataset consisting of dogs and cats images from <a href="https://www.kaggle.com/c/dogs-vs-cats">Dogs vs Cats kaggle competition</a>. </li>
</ol>
<p><strong>Image Classification datasets</strong>:</p>
<ol>
<li><strong>CALTECH_101</strong>: Pictures of objects belonging to 101 categories. About 40 to 800 images per category. Most categories have about 50 images. Collected in September 2003 by Fei-Fei Li, Marco Andreetto, and Marc 'Aurelio Ranzato.</li>
<li>CARS: The <a href="https://ai.stanford.edu/~jkrause/cars/car_dataset.html">Cars dataset</a> contains 16,185 images of 196 classes of cars.   </li>
<li><strong>CIFAR_100</strong>: The CIFAR-100 dataset consists of 60000 32x32 colour images in 100 classes, with 600 images per class.   </li>
<li><strong>CUB_200_2011</strong>: Caltech-UCSD Birds-200-2011 (CUB-200-2011) is an extended version of the CUB-200 dataset, with roughly double the number of images per class and new part location annotations</li>
<li><strong>FLOWERS</strong>: 17 category <a href="http://www.robots.ox.ac.uk/~vgg/data/flowers/">flower dataset</a> by gathering images from various websites.</li>
<li><strong>FOOD</strong>:         </li>
<li><strong>MNIST</strong>: <a href="http://yann.lecun.com/exdb/mnist/">MNIST dataset</a> consisting of handwritten digits.      </li>
<li><strong>PETS</strong>: A 37 category <a href="https://www.robots.ox.ac.uk/~vgg/data/pets/">pet dataset</a> with roughly 200 images for each class.</li>
</ol>
<p><strong>NLP datasets</strong>:</p>
<ol>
<li><strong>AG_NEWS</strong>: The AG News corpus consists of news articles from the AGâ€™s corpus of news articles on the web pertaining to the 4 largest classes. The dataset contains 30,000 training and 1,900 testing examples for each class.</li>
<li><strong>AMAZON_REVIEWS</strong>: This dataset contains product reviews and metadata from Amazon, including 142.8 million reviews spanning May 1996 - July 2014.</li>
<li><strong>AMAZON_REVIEWS_POLARITY</strong>: Amazon reviews dataset for sentiment analysis.</li>
<li><strong>DBPEDIA</strong>: The DBpedia ontology dataset contains 560,000 training samples and 70,000 testing samples for each of 14 nonoverlapping classes from DBpedia. </li>
<li><strong>MT_ENG_FRA</strong>: Machine translation dataset from English to French.</li>
<li><strong>SOGOU_NEWS</strong>: <a href="http://www.thuir.cn/data-srr/">The Sogou-SRR</a> (Search Result Relevance) dataset was constructed to support researches on search engine relevance estimation and ranking tasks.</li>
<li><strong>WIKITEXT</strong>: The <a href="https://blog.einstein.ai/the-wikitext-long-term-dependency-language-modeling-dataset/">WikiText language modeling dataset</a> is a collection of over 100 million tokens extracted from the set of verified Good and Featured articles on Wikipedia.  </li>
<li><strong>WIKITEXT_TINY</strong>: A tiny version of the WIKITEXT dataset.</li>
<li><strong>YAHOO_ANSWERS</strong>: YAHOO's question answers dataset.</li>
<li><strong>YELP_REVIEWS</strong>: The <a href="https://www.yelp.com/dataset">Yelp dataset</a> is a subset of YELP businesses, reviews, and user data for use in personal, educational, and academic purposes</li>
<li><strong>YELP_REVIEWS_POLARITY</strong>: For sentiment classification on YELP reviews.</li>
</ol>
<p><strong>Image localization datasets</strong>:</p>
<ol>
<li><strong>BIWI_HEAD_POSE</strong>: A <a href="https://www.kaggle.com/kmader/biwi-kinect-head-pose-database">BIWI kinect headpose database</a>. The dataset contains over 15K images of 20 people (6 females and 14 males - 4 people were recorded twice). For each frame, a depth image, the corresponding rgb image (both 640x480 pixels), and the annotation is provided. The head pose range covers about +-75 degrees yaw and +-60 degrees pitch. </li>
<li><strong>CAMVID</strong>: Consists of driving labelled dataset for segmentation type models.</li>
<li><strong>CAMVID_TINY</strong>: A tiny camvid dataset for segmentation type models.</li>
<li><strong>LSUN_BEDROOMS</strong>: <a href="https://arxiv.org/abs/1506.03365">Large-scale Image Dataset</a> using Deep Learning with Humans in the Loop</li>
<li><strong>PASCAL_2007</strong>: <a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2007/">Pascal 2007 dataset</a> to recognize objects from a number of visual object classes in realistic scenes.</li>
<li><strong>PASCAL_2012</strong>: <a href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/">Pascal 2012 dataset</a> to recognize objects from a number of visual object classes in realistic scenes.</li>
</ol>
<p><strong>Audio classification</strong>:</p>
<ol>
<li><strong>MACAQUES</strong>: <a href="https://datadryad.org/stash/dataset/doi:10.5061/dryad.7f4p9">7285 macaque coo calls</a> across 8 individuals from <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4806230">Distributed acoustic cues for caller identity in macaque vocalization</a>.</li>
<li><strong>ZEBRA_FINCH</strong>: <a href="https://ndownloader.figshare.com/articles/11905533/versions/1">3405 zebra finch calls</a> classified <a href="https://link.springer.com/article/10.1007/s10071-015-0933-6">across 11 call types</a>. Additonal labels include name of individual making the vocalization and its age.</li>
</ol>
<p><strong>Medical Imaging datasets</strong>:</p>
<ol>
<li><strong>SIIM_SMALL</strong>: A smaller version of the <a href="https://www.kaggle.com/c/siim-acr-pneumothorax-segmentation/overview">SIIM dataset</a> where the objective is to classify pneumothorax from a set of chest radiographic images.</li>
</ol>
<p><strong>Pretrained models</strong>:</p>
<ol>
<li><strong>OPENAI_TRANSFORMER</strong>: The GPT2 Transformer pretrained weights.</li>
<li><strong>WT103_FWD</strong>: The WikiText-103 forward language model weights.</li>
<li><strong>WT103_BWD</strong>: The WikiText-103 backward language model weights.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To download any of the datasets or pretrained weights, simply run <a href="/data.external#untar_data"><code>untar_data</code></a> by passing any dataset name mentioned above like so:</p>
<div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">PETS</span><span class="p">)</span>
<span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
<span class="o">&gt;</span> <span class="o">&gt;</span> <span class="p">(</span><span class="c1">#7393) [Path(&#39;/home/ubuntu/.fastai/data/oxford-iiit-pet/images/keeshond_34.jpg&#39;),Path(&#39;/home/ubuntu/.fastai/data/oxford-iiit-pet/images/Siamese_178.jpg&#39;),Path(&#39;/home/ubuntu/.fastai/data/oxford-iiit-pet/images/german_shorthaired_94.jpg&#39;),Path(&#39;/home/ubuntu/.fastai/data/oxford-iiit-pet/images/Abyssinian_92.jpg&#39;),Path(&#39;/home/ubuntu/.fastai/data/oxford-iiit-pet/images/basset_hound_111.jpg&#39;),Path(&#39;/home/ubuntu/.fastai/data/oxford-iiit-pet/images/Russian_Blue_194.jpg&#39;),Path(&#39;/home/ubuntu/.fastai/data/oxford-iiit-pet/images/staffordshire_bull_terrier_91.jpg&#39;),Path(&#39;/home/ubuntu/.fastai/data/oxford-iiit-pet/images/Persian_69.jpg&#39;),Path(&#39;/home/ubuntu/.fastai/data/oxford-iiit-pet/images/english_setter_33.jpg&#39;),Path(&#39;/home/ubuntu/.fastai/data/oxford-iiit-pet/images/Russian_Blue_155.jpg&#39;)...]</span>
</pre></div>
<p>To download model pretrained weights:```python path = untar_data(URLs.PETS)
path.ls()</p>
<blockquote><blockquote><p>(#2) [Path('/home/ubuntu/.fastai/data/wt103-bwd/itos_wt103.pkl'),Path('/home/ubuntu/.fastai/data/wt103-bwd/lstm_bwd.pth')]
```</p>
</blockquote>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Config" class="doc_header"><code>class</code> <code>Config</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/external.py#L10" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Config</code>()</p>
</blockquote>
<p>Setup config at <code>~/.fastai</code> unless it exists already.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If a config file doesn't exist already, it is always created at <code>~/.fastai/config.yml</code> location by default whenever an instance of the <a href="/data.external#Config"><code>Config</code></a> class is created. Here is a quick example to explain:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;~/.fastai/config.yml&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="k">if</span> <span class="n">config_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">config_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">config_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The config is now available as <code>config.d</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">d</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;archive_path&#39;: &#39;/home/sgugger/.fastai/archive&#39;,
 &#39;data_path&#39;: &#39;/home/sgugger/.fastai/data&#39;,
 &#39;model_path&#39;: &#39;/home/sgugger/.fastai/models&#39;,
 &#39;storage_path&#39;: &#39;/home/sgugger/.fastai/data&#39;,
 &#39;version&#39;: 2}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As can be seen, this is a basic config file that consists of <code>data_path</code>, <code>model_path</code>, <code>storage_path</code> and <code>archive_path</code>. 
All future downloads occur at the paths defined in the config file based on the type of download. For example, all future fastai datasets are downloaded to the <code>data_path</code> while all pretrained model weights are download to <code>model_path</code> unless the default download location is updated.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Please note that it is possible to update the default path locations in the config file. Let's first create a backup of the config file, then update the config to show the changes and re update the new config with the backup file.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">config_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span> <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="n">config_bak</span><span class="p">)</span>
<span class="n">config</span><span class="p">[</span><span class="s1">&#39;archive_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">config</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">d</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;archive_path&#39;: &#39;.&#39;,
 &#39;data_archive_path&#39;: &#39;/home/sgugger/.fastai/data&#39;,
 &#39;data_path&#39;: &#39;/home/sgugger/.fastai/data&#39;,
 &#39;model_path&#39;: &#39;/home/sgugger/.fastai/models&#39;,
 &#39;storage_path&#39;: &#39;/home/sgugger/.fastai/data&#39;,
 &#39;version&#39;: 2}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>archive_path</code> has been updated to <code>"."</code>. Now let's remove any updates we made to Config file that we made for the purpose of this example.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">config_bak</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span> <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">config_bak</span><span class="p">,</span> <span class="n">config_file</span><span class="p">)</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">d</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;archive_path&#39;: &#39;/home/sgugger/.fastai/archive&#39;,
 &#39;data_archive_path&#39;: &#39;/home/sgugger/.fastai/data&#39;,
 &#39;data_path&#39;: &#39;/home/sgugger/.fastai/data&#39;,
 &#39;model_path&#39;: &#39;/home/sgugger/.fastai/models&#39;,
 &#39;storage_path&#39;: &#39;/home/sgugger/.fastai/data&#39;,
 &#39;version&#39;: 2}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="URLs" class="doc_header"><code>class</code> <code>URLs</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/external.py#L59" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>URLs</code>()</p>
</blockquote>
<p>Global constants for dataset and model URLs.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The default local path is at <code>~/.fastai/archive/</code> but this can be updated by passing a different <code>c_key</code>. Note: <code>c_key</code> should be one of <code>'archive_path', 'data_archive_path', 'data_path', 'model_path', 'storage_path'</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="n">URLs</span><span class="o">.</span><span class="n">PETS</span>
<span class="n">local_path</span> <span class="o">=</span> <span class="n">URLs</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">local_path</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">Config</span><span class="p">()[</span><span class="s1">&#39;archive&#39;</span><span class="p">]);</span> 
<span class="n">local_path</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;/home/sgugger/.fastai/archive/oxford-iiit-pet.tgz&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">local_path</span> <span class="o">=</span> <span class="n">URLs</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">c_key</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">local_path</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">Config</span><span class="p">()[</span><span class="s1">&#39;model&#39;</span><span class="p">])</span>
<span class="n">local_path</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;/home/sgugger/.fastai/models/oxford-iiit-pet.tgz&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Downloading">Downloading<a class="anchor-link" href="#Downloading"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="download_url" class="doc_header"><code>download_url</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/external.py#L154" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>download_url</code>(<strong><code>url</code></strong>, <strong><code>dest</code></strong>, <strong><code>overwrite</code></strong>=<em><code>False</code></em>, <strong><code>pbar</code></strong>=<em><code>None</code></em>, <strong><code>show_progress</code></strong>=<em><code>True</code></em>, <strong><code>chunk_size</code></strong>=<em><code>1048576</code></em>, <strong><code>timeout</code></strong>=<em><code>4</code></em>, <strong><code>retries</code></strong>=<em><code>5</code></em>)</p>
</blockquote>
<p>Download <code>url</code> to <code>dest</code> unless it exists and not <code>overwrite</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/data.external#download_url"><code>download_url</code></a> is a very handy function inside fastai! This function can be used to download any file from the internet to a location passed by <code>dest</code> argument of the function. It should not be confused, that this function can only be used to download fastai-files. That couldn't be further away from the truth. As an example, let's download the pets dataset from the actual source file:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./dog.jpg&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">fname</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://i.insider.com/569fdd9ac08a80bd448b7138?width=1100&amp;format=jpeg&amp;auto=webp&quot;</span>
<span class="n">download_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">fname</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's confirm that the file was indeed downloaded correctly.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-6-153e9d88ae05&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">from</span> PIL <span class="ansi-green-fg">import</span> Image
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>im <span class="ansi-blue-fg">=</span> Image<span class="ansi-blue-fg">.</span>open<span class="ansi-blue-fg">(</span>fname<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> plt<span class="ansi-blue-fg">.</span>imshow<span class="ansi-blue-fg">(</span>im<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>

<span class="ansi-red-fg">NameError</span>: name &#39;fname&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As can be seen, the file has been downloaded to the local path provided in <code>dest</code> argument. Calling the function again doesn't trigger a download since the file is already there. This can be confirmed by checking that the last modified time of the file that is downloaded doesn't get updated.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">fname</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span> <span class="n">last_modified_time</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="n">download_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">fname</span><span class="p">),</span> <span class="n">last_modified_time</span><span class="p">)</span>
<span class="k">if</span> <span class="n">fname</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also use the <a href="/data.external#download_url"><code>download_url</code></a> function to download the pet's dataset straight from the source by simply passing <code>https://www.robots.ox.ac.uk/~vgg/data/pets/data/images.tar.gz</code> in <code>url</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="download_data" class="doc_header"><code>download_data</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/external.py#L188" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>download_data</code>(<strong><code>url</code></strong>, <strong><code>fname</code></strong>=<em><code>None</code></em>, <strong><code>c_key</code></strong>=<em><code>'archive'</code></em>, <strong><code>force_download</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Download <code>url</code> to <code>fname</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/data.external#download_data"><code>download_data</code></a> is a convenience function and a wrapper outside <a href="/data.external#download_url"><code>download_url</code></a> to download fastai files to the appropriate local path based on the <code>c_key</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If <code>fname</code> is None, it will default to the archive folder you have in your config file (or data, model if you specify a different <code>c_key</code>) followed by the last part of the url: for instance <a href="/data.external#URLs.MNIST_SAMPLE"><code>URLs.MNIST_SAMPLE</code></a> is <code>http://files.fast.ai/data/examples/mnist_sample.tgz</code> and the default value for <code>fname</code> will be <code>~/.fastai/archive/mnist_sample.tgz</code>.</p>
<p>If <code>force_download=True</code>, the file is alwayd downloaded. Otherwise, it's only when the file doesn't exists that the download is triggered.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_get_check</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">PASCAL_2007</span><span class="p">),</span><span class="n">_get_check</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">PASCAL_2012</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([1637796771, &#39;433b4706eb7c42bd74e7f784e3fdf244&#39;],
 [2618908000, &#39;d90e29e54a4c76c0c6fba8355dcbaca5&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Extract">Extract<a class="anchor-link" href="#Extract"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="file_extract" class="doc_header"><code>file_extract</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/external.py#L215" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>file_extract</code>(<strong><code>fname</code></strong>, <strong><code>dest</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Extract <code>fname</code> to <code>dest</code> using <code>tarfile</code> or <code>zipfile</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/data.external#file_extract"><code>file_extract</code></a> is used by default in <a href="/data.external#untar_data"><code>untar_data</code></a> to decompress the downloaded file.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="newest_folder" class="doc_header"><code>newest_folder</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/external.py#L231" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>newest_folder</code>(<strong><code>path</code></strong>)</p>
</blockquote>
<p>Return newest folder on path</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rename_extracted" class="doc_header"><code>rename_extracted</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/external.py#L237" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rename_extracted</code>(<strong><code>dest</code></strong>)</p>
</blockquote>
<p>Rename file if different from dest</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>let's rename the untar/unzip data if dest name is different from fname</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="untar_data" class="doc_header"><code>untar_data</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/external.py#L243" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>untar_data</code>(<strong><code>url</code></strong>, <strong><code>fname</code></strong>=<em><code>None</code></em>, <strong><code>dest</code></strong>=<em><code>None</code></em>, <strong><code>c_key</code></strong>=<em><code>'data'</code></em>, <strong><code>force_download</code></strong>=<em><code>False</code></em>, <strong><code>extract_func</code></strong>=<em><code>'file_extract'</code></em>)</p>
</blockquote>
<p>Download <code>url</code> to <code>fname</code> if <code>dest</code> doesn't exist, and un-tgz or unzip to folder <code>dest</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/data.external#untar_data"><code>untar_data</code></a> is a very powerful convenience function to download files from <code>url</code> to <code>dest</code>. The <code>url</code> can be a default <code>url</code> from the <a href="/data.external#URLs"><code>URLs</code></a> class or a custom url. If <code>dest</code> is not passed, files are downloaded at the <code>default_dest</code> which defaults to <code>~/.fastai/data/</code>.</p>
<p>This convenience function extracts the downloaded files to <code>dest</code> by default. In order, to simply download the files without extracting, pass the <code>noop</code> function as <code>extract_func</code>.</p>
<p>Note, it is also possible to pass a custom <code>extract_func</code> to <a href="/data.external#untar_data"><code>untar_data</code></a> if the filetype doesn't end with <code>.tgz</code> or <code>.zip</code>. The <code>gzip</code> and <code>zip</code> files are supported by default and there is no need to pass custom <code>extract_func</code> for these type of files.</p>
<p>Internally, if files are not available at <code>fname</code> location already which defaults to <code>~/.fastai/archive/</code>, the files get downloaded at <code>~/.fastai/archive</code> and are then extracted at <code>dest</code> location. If no <code>dest</code> is passed the <code>default_dest</code> to download the files is <code>~/.fastai/data</code>. If files are already available at the <code>fname</code> location but not available then a symbolic link is created for each file from <code>fname</code> location to <code>dest</code>.</p>
<p>Also, if <code>force_download</code> is set to <code>True</code>, files are re downloaded even if they exist.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_SAMPLE</span><span class="p">),</span> <span class="n">config</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="s1">&#39;mnist_sample&#39;</span><span class="p">)</span>

<span class="c1">#Test specific fname</span>
<span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;mnist_tiny.tgz&#39;</span><span class="p">,</span> <span class="n">force_download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;mnist_tiny.tgz&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
    
<span class="c1">#Test specific dest</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">),</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;mnist_tiny&#39;</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;mnist_tiny&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;mnist_tiny&#39;</span><span class="p">))</span>

<span class="c1">#Test c_key</span>
<span class="n">tst_model</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">model</span><span class="o">/</span><span class="s1">&#39;mnist_sample&#39;</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_SAMPLE</span><span class="p">,</span> <span class="n">c_key</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">),</span> <span class="n">tst_model</span><span class="p">)</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">tst_model</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.tgz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="c1">#Archive wasn&#39;t downloaded in the models path</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">archive</span><span class="o">/</span><span class="s1">&#39;mnist_sample.tgz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="c1">#Archive was downloaded there</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tst_model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes the extracted folder does not have the same name as the downloaded file.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="s1">&#39;mnist_tiny.tgz&#39;</span><span class="p">,</span> <span class="n">force_download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Path</span><span class="p">(</span><span class="s1">&#39;mnist_tiny.tgz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;nims_tini.tgz&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;nims_tini.tgz&#39;</span><span class="p">)</span>
<span class="n">dest</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;nims_tini&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<span class="n">file_extract</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">dest</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
<span class="n">rename_extracted</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

